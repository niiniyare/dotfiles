"use strict";

var _ = require("./..");

const bases = {
  babel: {
    presets: ["next/babel"]
  },
  package: {
    name: "test-refine",
    version: "0.1.0",
    private: true,
    scripts: {
      dev: "next dev",
      build: "next build",
      start: "next start"
    },
    dependencies: {
      next: "10.2.0",
      react: "17.0.2",
      "react-dom": "17.0.2",
      "next-compose-plugins": "^2.2.1"
    },
    devDependencies: {
      "@types/node": "^14.14.13",
      "@types/react": "^17.0.0",
      "@types/react-dom": "^17.0.0",
      typescript: "^4.1.3"
    }
  },
  extend: {
    _app: {
      refineImports: [],
      import: [],
      innerHooks: [],
      inner: [],
      refineProps: []
    }
  }
};
const plugins = [{
  babelrc: {
    presets: ["next/babel"],
    plugins: [["styled-components", {
      ssr: true
    }]]
  },
  extend: {
    _app: {
      refineProps: ["Title={Title}", "Header={Header}", "Sider={Sider}", "Footer={Footer}", "Layout={Layout}", "OffLayoutArea={OffLayoutArea}"],
      import: [`import {Title, Header, Sider, Footer, Layout, OffLayoutArea} from "components"`]
    }
  }
}, {
  package: {
    scripts: {
      "apollo:download-schema": "apollo client:download-schema schema.graphql",
      "apollo:generate-types": "rm -rf __generated__ && apollo client:codegen --target typescript --outputFlat",
      "apollo:sync": "npm run apollo:download-schema && npm run apollo:generate-types"
    },
    dependencies: {
      "@apollo/client": "^3.3.7",
      graphql: "^15.4.0"
    },
    devDependencies: {
      apollo: "^2.32.1"
    }
  },
  extend: {
    _app: {
      import: [`import { useTranslation } from "react-i18next";`],
      innerHooks: [`const { t, i18n } = useTranslation();`],
      inner: [`
                    const i18nProvider = {
                        translate: (key: string, params: object) => t(key, params),
                        changeLocale: (lang: string) => i18n.changeLanguage(lang),
                        getLocale: () => i18n.language,
                    };
                    `],
      refineProps: ["i18nProvider={i18nProvider}", "Header={Header}"]
    }
  }
}, {
  package: {
    dependencies: {
      "@chakra-ui/react": "^1.1.4",
      "@emotion/react": "^11.1.4",
      "@emotion/styled": "^11.0.0",
      "framer-motion": "^3.2.1"
    }
  }
}, {
  babelrc: {
    presets: ["next/babel"]
  }
}];
describe("Merge Helper", () => {
  it("merges babelrc from plugins successfully", () => {
    const mergedBabelrc = (0, _.mergeWithUnionArray)(bases.babel, ...plugins.map(p => {
      var _p$babelrc;

      return (_p$babelrc = p.babelrc) !== null && _p$babelrc !== void 0 ? _p$babelrc : {};
    }));
    expect(mergedBabelrc).toEqual({
      presets: ["next/babel"],
      plugins: [["styled-components", {
        ssr: true
      }]]
    });
  });
  it("merges package.json from plugins successfully", () => {
    const mergedPackages = (0, _.mergeWithUnionArray)(bases.package, ...plugins.map(p => {
      var _p$package;

      return (_p$package = p.package) !== null && _p$package !== void 0 ? _p$package : {};
    }));
    expect(mergedPackages).toEqual({
      name: "test-refine",
      version: "0.1.0",
      private: true,
      scripts: {
        dev: "next dev",
        build: "next build",
        start: "next start",
        "apollo:download-schema": "apollo client:download-schema schema.graphql",
        "apollo:generate-types": "rm -rf __generated__ && apollo client:codegen --target typescript --outputFlat",
        "apollo:sync": "npm run apollo:download-schema && npm run apollo:generate-types"
      },
      dependencies: {
        next: "10.2.0",
        react: "17.0.2",
        "react-dom": "17.0.2",
        "next-compose-plugins": "^2.2.1",
        "@chakra-ui/react": "^1.1.4",
        "@emotion/react": "^11.1.4",
        "@emotion/styled": "^11.0.0",
        "framer-motion": "^3.2.1",
        "@apollo/client": "^3.3.7",
        graphql: "^15.4.0"
      },
      devDependencies: {
        "@types/node": "^14.14.13",
        "@types/react": "^17.0.0",
        "@types/react-dom": "^17.0.0",
        typescript: "^4.1.3",
        apollo: "^2.32.1"
      }
    });
  });
  it("merges extend.js from plugins successfully", () => {
    const mergedExtend = (0, _.mergeWithUnionArray)(bases.extend, ...plugins.map(p => {
      var _p$extend;

      return (_p$extend = p.extend) !== null && _p$extend !== void 0 ? _p$extend : {};
    }));
    expect(mergedExtend).toMatchInlineSnapshot(`
            Object {
              "_app": Object {
                "import": Array [
                  "import {Title, Header, Sider, Footer, Layout, OffLayoutArea} from \\"components\\"",
                  "import { useTranslation } from \\"react-i18next\\";",
                ],
                "inner": Array [
                  "
                                const i18nProvider = {
                                    translate: (key: string, params: object) => t(key, params),
                                    changeLocale: (lang: string) => i18n.changeLanguage(lang),
                                    getLocale: () => i18n.language,
                                };
                                ",
                ],
                "innerHooks": Array [
                  "const { t, i18n } = useTranslation();",
                ],
                "refineImports": Array [],
                "refineProps": Array [
                  "Title={Title}",
                  "Header={Header}",
                  "Sider={Sider}",
                  "Footer={Footer}",
                  "Layout={Layout}",
                  "OffLayoutArea={OffLayoutArea}",
                  "i18nProvider={i18nProvider}",
                ],
              },
            }
        `);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9IZWxwZXIvbWVyZ2UvaW5kZXguc3BlYy50cyJdLCJuYW1lcyI6WyJiYXNlcyIsImJhYmVsIiwicHJlc2V0cyIsInBhY2thZ2UiLCJuYW1lIiwidmVyc2lvbiIsInByaXZhdGUiLCJzY3JpcHRzIiwiZGV2IiwiYnVpbGQiLCJzdGFydCIsImRlcGVuZGVuY2llcyIsIm5leHQiLCJyZWFjdCIsImRldkRlcGVuZGVuY2llcyIsInR5cGVzY3JpcHQiLCJleHRlbmQiLCJfYXBwIiwicmVmaW5lSW1wb3J0cyIsImltcG9ydCIsImlubmVySG9va3MiLCJpbm5lciIsInJlZmluZVByb3BzIiwicGx1Z2lucyIsImJhYmVscmMiLCJzc3IiLCJncmFwaHFsIiwiYXBvbGxvIiwiZGVzY3JpYmUiLCJpdCIsIm1lcmdlZEJhYmVscmMiLCJtYXAiLCJwIiwiZXhwZWN0IiwidG9FcXVhbCIsIm1lcmdlZFBhY2thZ2VzIiwibWVyZ2VkRXh0ZW5kIiwidG9NYXRjaElubGluZVNuYXBzaG90Il0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUVBLE1BQU1BLEtBQUssR0FBRztBQUNWQyxFQUFBQSxLQUFLLEVBQUU7QUFDSEMsSUFBQUEsT0FBTyxFQUFFLENBQUMsWUFBRDtBQUROLEdBREc7QUFJVkMsRUFBQUEsT0FBTyxFQUFFO0FBQ0xDLElBQUFBLElBQUksRUFBRSxhQUREO0FBRUxDLElBQUFBLE9BQU8sRUFBRSxPQUZKO0FBR0xDLElBQUFBLE9BQU8sRUFBRSxJQUhKO0FBSUxDLElBQUFBLE9BQU8sRUFBRTtBQUNMQyxNQUFBQSxHQUFHLEVBQUUsVUFEQTtBQUVMQyxNQUFBQSxLQUFLLEVBQUUsWUFGRjtBQUdMQyxNQUFBQSxLQUFLLEVBQUU7QUFIRixLQUpKO0FBU0xDLElBQUFBLFlBQVksRUFBRTtBQUNWQyxNQUFBQSxJQUFJLEVBQUUsUUFESTtBQUVWQyxNQUFBQSxLQUFLLEVBQUUsUUFGRztBQUdWLG1CQUFhLFFBSEg7QUFJViw4QkFBd0I7QUFKZCxLQVRU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QUEyQ0FFLEVBQUFBLEVBQUUsQ0FBQyw0Q0FBRCxFQUErQyxNQUFNO0FBQ25ELFVBQU1PLFlBQVksR0FBRywyQkFDakJwQyxLQUFLLENBQUNnQixNQURXLEVBRWpCLEdBQUdPLE9BQU8sQ0FBQ1EsR0FBUixDQUFhQyxDQUFEO0FBQUE7O0FBQUEsMEJBQU9BLENBQUMsQ0FBQ2hCLE1BQVQsaURBQW1CLEVBQW5CO0FBQUEsS0FBWixDQUZjLENBQXJCO0FBS0FpQixJQUFBQSxNQUFNLENBQUNHLFlBQUQsQ0FBTixDQUFxQkMscUJBQXJCLENBQTRDO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBL0JRO0FBZ0NILEdBdENDLENBQUY7QUF1Q0gsQ0EvRk8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IG1lcmdlV2l0aFVuaW9uQXJyYXkgfSBmcm9tIFwiQEhlbHBlclwiO1xuXG5jb25zdCBiYXNlcyA9IHtcbiAgICBiYWJlbDoge1xuICAgICAgICBwcmVzZXRzOiBbXCJuZXh0L2JhYmVsXCJdLFxuICAgIH0sXG4gICAgcGFja2FnZToge1xuICAgICAgICBuYW1lOiBcInRlc3QtcmVmaW5lXCIsXG4gICAgICAgIHZlcnNpb246IFwiMC4xLjBcIixcbiAgICAgICAgcHJpdmF0ZTogdHJ1ZSxcbiAgICAgICAgc2NyaXB0czoge1xuICAgICAgICAgICAgZGV2OiBcIm5leHQgZGV2XCIsXG4gICAgICAgICAgICBidWlsZDogXCJuZXh0IGJ1aWxkXCIsXG4gICAgICAgICAgICBzdGFydDogXCJuZXh0IHN0YXJ0XCIsXG4gICAgICAgIH0sXG4gICAgICAgIGRlcGVuZGVuY2llczoge1xuICAgICAgICAgICAgbmV4dDogXCIxMC4yLjBcIixcbiAgICAgICAgICAgIHJlYWN0OiBcIjE3LjAuMlwiLFxuICAgICAgICAgICAgXCJyZWFjdC1kb21cIjogXCIxNy4wLjJcIixcbiAgICAgICAgICAgIFwibmV4dC1jb21wb3NlLXBsdWdpbnNcIjogXCJeMi4yLjFcIixcbiAgICAgICAgfSxcbiAgICAgICAgZGV2RGVwZW5kZW5jaWVzOiB7XG4gICAgICAgICAgICBcIkB0eXBlcy9ub2RlXCI6IFwiXjE0LjE0LjEzXCIsXG4gICAgICAgICAgICBcIkB0eXBlcy9yZWFjdFwiOiBcIl4xNy4wLjBcIixcbiAgICAgICAgICAgIFwiQHR5cGVzL3JlYWN0LWRvbVwiOiBcIl4xNy4wLjBcIixcbiAgICAgICAgICAgIHR5cGVzY3JpcHQ6IFwiXjQuMS4zXCIsXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICBleHRlbmQ6IHtcbiAgICAgICAgX2FwcDoge1xuICAgICAgICAgICAgcmVmaW5lSW1wb3J0czogW10sXG4gICAgICAgICAgICBpbXBvcnQ6IFtdLFxuICAgICAgICAgICAgaW5uZXJIb29rczogW10sXG4gICAgICAgICAgICBpbm5lcjogW10sXG4gICAgICAgICAgICByZWZpbmVQcm9wczogW10sXG4gICAgICAgIH0sXG4gICAgfSxcbn07XG5cbmNvbnN0IHBsdWdpbnMgPSBbXG4gICAge1xuICAgICAgICBiYWJlbHJjOiB7XG4gICAgICAgICAgICBwcmVzZXRzOiBbXCJuZXh0L2JhYmVsXCJdLFxuICAgICAgICAgICAgcGx1Z2luczogW1tcInN0eWxlZC1jb21wb25lbnRzXCIsIHsgc3NyOiB0cnVlIH1dXSxcbiAgICAgICAgfSxcbiAgICAgICAgZXh0ZW5kOiB7XG4gICAgICAgICAgICBfYXBwOiB7XG4gICAgICAgICAgICAgICAgcmVmaW5lUHJvcHM6IFtcbiAgICAgICAgICAgICAgICAgICAgXCJUaXRsZT17VGl0bGV9XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiSGVhZGVyPXtIZWFkZXJ9XCIsXG4gICAgICAgICAgICAgICAgICAgIFwiU2lkZXI9e1NpZGVyfVwiLFxuICAgICAgICAgICAgICAgICAgICBcIkZvb3Rlcj17Rm9vdGVyfVwiLFxuICAgICAgICAgICAgICAgICAgICBcIkxheW91dD17TGF5b3V0fVwiLFxuICAgICAgICAgICAgICAgICAgICBcIk9mZkxheW91dEFyZWE9e09mZkxheW91dEFyZWF9XCIsXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBpbXBvcnQ6IFtcbiAgICAgICAgICAgICAgICAgICAgYGltcG9ydCB7VGl0bGUsIEhlYWRlciwgU2lkZXIsIEZvb3RlciwgTGF5b3V0LCBPZmZMYXlvdXRBcmVhfSBmcm9tIFwiY29tcG9uZW50c1wiYCxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgcGFja2FnZToge1xuICAgICAgICAgICAgc2NyaXB0czoge1xuICAgICAgICAgICAgICAgIFwiYXBvbGxvOmRvd25sb2FkLXNjaGVtYVwiOlxuICAgICAgICAgICAgICAgICAgICBcImFwb2xsbyBjbGllbnQ6ZG93bmxvYWQtc2NoZW1hIHNjaGVtYS5ncmFwaHFsXCIsXG4gICAgICAgICAgICAgICAgXCJhcG9sbG86Z2VuZXJhdGUtdHlwZXNcIjpcbiAgICAgICAgICAgICAgICAgICAgXCJybSAtcmYgX19nZW5lcmF0ZWRfXyAmJiBhcG9sbG8gY2xpZW50OmNvZGVnZW4gLS10YXJnZXQgdHlwZXNjcmlwdCAtLW91dHB1dEZsYXRcIixcbiAgICAgICAgICAgICAgICBcImFwb2xsbzpzeW5jXCI6XG4gICAgICAgICAgICAgICAgICAgIFwibnBtIHJ1biBhcG9sbG86ZG93bmxvYWQtc2NoZW1hICYmIG5wbSBydW4gYXBvbGxvOmdlbmVyYXRlLXR5cGVzXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGVwZW5kZW5jaWVzOiB7XG4gICAgICAgICAgICAgICAgXCJAYXBvbGxvL2NsaWVudFwiOiBcIl4zLjMuN1wiLFxuICAgICAgICAgICAgICAgIGdyYXBocWw6IFwiXjE1LjQuMFwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRldkRlcGVuZGVuY2llczoge1xuICAgICAgICAgICAgICAgIGFwb2xsbzogXCJeMi4zMi4xXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBleHRlbmQ6IHtcbiAgICAgICAgICAgIF9hcHA6IHtcbiAgICAgICAgICAgICAgICBpbXBvcnQ6IFtgaW1wb3J0IHsgdXNlVHJhbnNsYXRpb24gfSBmcm9tIFwicmVhY3QtaTE4bmV4dFwiO2BdLFxuICAgICAgICAgICAgICAgIGlubmVySG9va3M6IFtgY29uc3QgeyB0LCBpMThuIH0gPSB1c2VUcmFuc2xhdGlvbigpO2BdLFxuICAgICAgICAgICAgICAgIGlubmVyOiBbXG4gICAgICAgICAgICAgICAgICAgIGBcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaTE4blByb3ZpZGVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlOiAoa2V5OiBzdHJpbmcsIHBhcmFtczogb2JqZWN0KSA9PiB0KGtleSwgcGFyYW1zKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUxvY2FsZTogKGxhbmc6IHN0cmluZykgPT4gaTE4bi5jaGFuZ2VMYW5ndWFnZShsYW5nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldExvY2FsZTogKCkgPT4gaTE4bi5sYW5ndWFnZSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgYCxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIHJlZmluZVByb3BzOiBbXCJpMThuUHJvdmlkZXI9e2kxOG5Qcm92aWRlcn1cIiwgXCJIZWFkZXI9e0hlYWRlcn1cIl0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0sXG4gICAge1xuICAgICAgICBwYWNrYWdlOiB7XG4gICAgICAgICAgICBkZXBlbmRlbmNpZXM6IHtcbiAgICAgICAgICAgICAgICBcIkBjaGFrcmEtdWkvcmVhY3RcIjogXCJeMS4xLjRcIixcbiAgICAgICAgICAgICAgICBcIkBlbW90aW9uL3JlYWN0XCI6IFwiXjExLjEuNFwiLFxuICAgICAgICAgICAgICAgIFwiQGVtb3Rpb24vc3R5bGVkXCI6IFwiXjExLjAuMFwiLFxuICAgICAgICAgICAgICAgIFwiZnJhbWVyLW1vdGlvblwiOiBcIl4zLjIuMVwiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgYmFiZWxyYzogeyBwcmVzZXRzOiBbXCJuZXh0L2JhYmVsXCJdIH0sXG4gICAgfSxcbl07XG5cbmRlc2NyaWJlKFwiTWVyZ2UgSGVscGVyXCIsICgpID0+IHtcbiAgICBpdChcIm1lcmdlcyBiYWJlbHJjIGZyb20gcGx1Z2lucyBzdWNjZXNzZnVsbHlcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBtZXJnZWRCYWJlbHJjID0gbWVyZ2VXaXRoVW5pb25BcnJheShcbiAgICAgICAgICAgIGJhc2VzLmJhYmVsLFxuICAgICAgICAgICAgLi4ucGx1Z2lucy5tYXAoKHApID0+IHAuYmFiZWxyYyA/PyB7fSksXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KG1lcmdlZEJhYmVscmMpLnRvRXF1YWwoe1xuICAgICAgICAgICAgcHJlc2V0czogW1wibmV4dC9iYWJlbFwiXSxcbiAgICAgICAgICAgIHBsdWdpbnM6IFtbXCJzdHlsZWQtY29tcG9uZW50c1wiLCB7IHNzcjogdHJ1ZSB9XV0sXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoXCJtZXJnZXMgcGFja2FnZS5qc29uIGZyb20gcGx1Z2lucyBzdWNjZXNzZnVsbHlcIiwgKCkgPT4ge1xuICAgICAgICBjb25zdCBtZXJnZWRQYWNrYWdlcyA9IG1lcmdlV2l0aFVuaW9uQXJyYXkoXG4gICAgICAgICAgICBiYXNlcy5wYWNrYWdlLFxuICAgICAgICAgICAgLi4ucGx1Z2lucy5tYXAoKHApID0+IHAucGFja2FnZSA/PyB7fSksXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KG1lcmdlZFBhY2thZ2VzKS50b0VxdWFsKHtcbiAgICAgICAgICAgIG5hbWU6IFwidGVzdC1yZWZpbmVcIixcbiAgICAgICAgICAgIHZlcnNpb246IFwiMC4xLjBcIixcbiAgICAgICAgICAgIHByaXZhdGU6IHRydWUsXG4gICAgICAgICAgICBzY3JpcHRzOiB7XG4gICAgICAgICAgICAgICAgZGV2OiBcIm5leHQgZGV2XCIsXG4gICAgICAgICAgICAgICAgYnVpbGQ6IFwibmV4dCBidWlsZFwiLFxuICAgICAgICAgICAgICAgIHN0YXJ0OiBcIm5leHQgc3RhcnRcIixcbiAgICAgICAgICAgICAgICBcImFwb2xsbzpkb3dubG9hZC1zY2hlbWFcIjpcbiAgICAgICAgICAgICAgICAgICAgXCJhcG9sbG8gY2xpZW50OmRvd25sb2FkLXNjaGVtYSBzY2hlbWEuZ3JhcGhxbFwiLFxuICAgICAgICAgICAgICAgIFwiYXBvbGxvOmdlbmVyYXRlLXR5cGVzXCI6XG4gICAgICAgICAgICAgICAgICAgIFwicm0gLXJmIF9fZ2VuZXJhdGVkX18gJiYgYXBvbGxvIGNsaWVudDpjb2RlZ2VuIC0tdGFyZ2V0IHR5cGVzY3JpcHQgLS1vdXRwdXRGbGF0XCIsXG4gICAgICAgICAgICAgICAgXCJhcG9sbG86c3luY1wiOlxuICAgICAgICAgICAgICAgICAgICBcIm5wbSBydW4gYXBvbGxvOmRvd25sb2FkLXNjaGVtYSAmJiBucG0gcnVuIGFwb2xsbzpnZW5lcmF0ZS10eXBlc1wiLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGRlcGVuZGVuY2llczoge1xuICAgICAgICAgICAgICAgIG5leHQ6IFwiMTAuMi4wXCIsXG4gICAgICAgICAgICAgICAgcmVhY3Q6IFwiMTcuMC4yXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFjdC1kb21cIjogXCIxNy4wLjJcIixcbiAgICAgICAgICAgICAgICBcIm5leHQtY29tcG9zZS1wbHVnaW5zXCI6IFwiXjIuMi4xXCIsXG4gICAgICAgICAgICAgICAgXCJAY2hha3JhLXVpL3JlYWN0XCI6IFwiXjEuMS40XCIsXG4gICAgICAgICAgICAgICAgXCJAZW1vdGlvbi9yZWFjdFwiOiBcIl4xMS4xLjRcIixcbiAgICAgICAgICAgICAgICBcIkBlbW90aW9uL3N0eWxlZFwiOiBcIl4xMS4wLjBcIixcbiAgICAgICAgICAgICAgICBcImZyYW1lci1tb3Rpb25cIjogXCJeMy4yLjFcIixcbiAgICAgICAgICAgICAgICBcIkBhcG9sbG8vY2xpZW50XCI6IFwiXjMuMy43XCIsXG4gICAgICAgICAgICAgICAgZ3JhcGhxbDogXCJeMTUuNC4wXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZGV2RGVwZW5kZW5jaWVzOiB7XG4gICAgICAgICAgICAgICAgXCJAdHlwZXMvbm9kZVwiOiBcIl4xNC4xNC4xM1wiLFxuICAgICAgICAgICAgICAgIFwiQHR5cGVzL3JlYWN0XCI6IFwiXjE3LjAuMFwiLFxuICAgICAgICAgICAgICAgIFwiQHR5cGVzL3JlYWN0LWRvbVwiOiBcIl4xNy4wLjBcIixcbiAgICAgICAgICAgICAgICB0eXBlc2NyaXB0OiBcIl40LjEuM1wiLFxuICAgICAgICAgICAgICAgIGFwb2xsbzogXCJeMi4zMi4xXCIsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KFwibWVyZ2VzIGV4dGVuZC5qcyBmcm9tIHBsdWdpbnMgc3VjY2Vzc2Z1bGx5XCIsICgpID0+IHtcbiAgICAgICAgY29uc3QgbWVyZ2VkRXh0ZW5kID0gbWVyZ2VXaXRoVW5pb25BcnJheShcbiAgICAgICAgICAgIGJhc2VzLmV4dGVuZCxcbiAgICAgICAgICAgIC4uLnBsdWdpbnMubWFwKChwKSA9PiBwLmV4dGVuZCA/PyB7fSksXG4gICAgICAgICk7XG5cbiAgICAgICAgZXhwZWN0KG1lcmdlZEV4dGVuZCkudG9NYXRjaElubGluZVNuYXBzaG90KGBcbiAgICAgICAgICAgIE9iamVjdCB7XG4gICAgICAgICAgICAgIFwiX2FwcFwiOiBPYmplY3Qge1xuICAgICAgICAgICAgICAgIFwiaW1wb3J0XCI6IEFycmF5IFtcbiAgICAgICAgICAgICAgICAgIFwiaW1wb3J0IHtUaXRsZSwgSGVhZGVyLCBTaWRlciwgRm9vdGVyLCBMYXlvdXQsIE9mZkxheW91dEFyZWF9IGZyb20gXFxcXFwiY29tcG9uZW50c1xcXFxcIlwiLFxuICAgICAgICAgICAgICAgICAgXCJpbXBvcnQgeyB1c2VUcmFuc2xhdGlvbiB9IGZyb20gXFxcXFwicmVhY3QtaTE4bmV4dFxcXFxcIjtcIixcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIFwiaW5uZXJcIjogQXJyYXkgW1xuICAgICAgICAgICAgICAgICAgXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaTE4blByb3ZpZGVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlOiAoa2V5OiBzdHJpbmcsIHBhcmFtczogb2JqZWN0KSA9PiB0KGtleSwgcGFyYW1zKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZUxvY2FsZTogKGxhbmc6IHN0cmluZykgPT4gaTE4bi5jaGFuZ2VMYW5ndWFnZShsYW5nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldExvY2FsZTogKCkgPT4gaTE4bi5sYW5ndWFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCIsXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBcImlubmVySG9va3NcIjogQXJyYXkgW1xuICAgICAgICAgICAgICAgICAgXCJjb25zdCB7IHQsIGkxOG4gfSA9IHVzZVRyYW5zbGF0aW9uKCk7XCIsXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBcInJlZmluZUltcG9ydHNcIjogQXJyYXkgW10sXG4gICAgICAgICAgICAgICAgXCJyZWZpbmVQcm9wc1wiOiBBcnJheSBbXG4gICAgICAgICAgICAgICAgICBcIlRpdGxlPXtUaXRsZX1cIixcbiAgICAgICAgICAgICAgICAgIFwiSGVhZGVyPXtIZWFkZXJ9XCIsXG4gICAgICAgICAgICAgICAgICBcIlNpZGVyPXtTaWRlcn1cIixcbiAgICAgICAgICAgICAgICAgIFwiRm9vdGVyPXtGb290ZXJ9XCIsXG4gICAgICAgICAgICAgICAgICBcIkxheW91dD17TGF5b3V0fVwiLFxuICAgICAgICAgICAgICAgICAgXCJPZmZMYXlvdXRBcmVhPXtPZmZMYXlvdXRBcmVhfVwiLFxuICAgICAgICAgICAgICAgICAgXCJpMThuUHJvdmlkZXI9e2kxOG5Qcm92aWRlcn1cIixcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfVxuICAgICAgICBgKTtcbiAgICB9KTtcbn0pO1xuIl19